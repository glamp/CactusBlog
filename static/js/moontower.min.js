/*
moontower - v0.0.0 - 2014-03-28
Real-time analytics tracking application.
Lovingly coded by Greg Lamp  - yhathq.com 
*/
function setCookie(cname,cvalue,exdays){var d=new Date;d.setTime(d.getTime()+24*exdays*60*60*1e3);var expires="expires="+d.toGMTString();document.cookie=cname+"="+cvalue+"; "+expires}function getCookie(cname){for(var name=cname+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){var c=ca[i].trim();if(0==c.indexOf(name))return c.substring(name.length,c.length)}return null}function guid(){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}!function(window,document,undefined){"use strict";function h2clog(a){_html2canvas.logging&&window.console&&window.console.log&&window.console.log(a)}function backgroundBoundsFactory(prop,el,bounds,image,imageIndex,backgroundSize){var topPos,left,percentage,val,bgposition=_html2canvas.Util.getCSS(el,prop,imageIndex);if(1===bgposition.length&&(val=bgposition[0],bgposition=[],bgposition[0]=val,bgposition[1]=val),-1!==bgposition[0].toString().indexOf("%"))percentage=parseFloat(bgposition[0])/100,left=bounds.width*percentage,"backgroundSize"!==prop&&(left-=(backgroundSize||image).width*percentage);else if("backgroundSize"===prop)if("auto"===bgposition[0])left=image.width;else if(bgposition[0].match(/contain|cover/)){var resized=_html2canvas.Util.resizeBounds(image.width,image.height,bounds.width,bounds.height,bgposition[0]);left=resized.width,topPos=resized.height}else left=parseInt(bgposition[0],10);else left=parseInt(bgposition[0],10);return"auto"===bgposition[1]?topPos=left/image.width*image.height:-1!==bgposition[1].toString().indexOf("%")?(percentage=parseFloat(bgposition[1])/100,topPos=bounds.height*percentage,"backgroundSize"!==prop&&(topPos-=(backgroundSize||image).height*percentage)):topPos=parseInt(bgposition[1],10),[left,topPos]}function h2cRenderContext(width,height){var storage=[];return{storage:storage,width:width,height:height,clip:function(){storage.push({type:"function",name:"clip",arguments:arguments})},translate:function(){storage.push({type:"function",name:"translate",arguments:arguments})},fill:function(){storage.push({type:"function",name:"fill",arguments:arguments})},save:function(){storage.push({type:"function",name:"save",arguments:arguments})},restore:function(){storage.push({type:"function",name:"restore",arguments:arguments})},fillRect:function(){storage.push({type:"function",name:"fillRect",arguments:arguments})},createPattern:function(){storage.push({type:"function",name:"createPattern",arguments:arguments})},drawShape:function(){var shape=[];return storage.push({type:"function",name:"drawShape",arguments:shape}),{moveTo:function(){shape.push({name:"moveTo",arguments:arguments})},lineTo:function(){shape.push({name:"lineTo",arguments:arguments})},arcTo:function(){shape.push({name:"arcTo",arguments:arguments})},bezierCurveTo:function(){shape.push({name:"bezierCurveTo",arguments:arguments})},quadraticCurveTo:function(){shape.push({name:"quadraticCurveTo",arguments:arguments})}}},drawImage:function(){storage.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){storage.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(variable,value){storage.push({type:"variable",name:variable,arguments:value})}}}function h2czContext(zindex){return{zindex:zindex,children:[]}}var previousElement,computedCSS,_html2canvas={};_html2canvas.Util={},_html2canvas.Util.trimText=function(isNative){return function(input){return isNative?isNative.apply(input):((input||"")+"").replace(/^\s+|\s+$/g,"")}}(String.prototype.trim),_html2canvas.Util.parseBackgroundImage=function(value){var method,definition,prefix,prefix_i,block,c,quote,args,whitespace=" \r\n	",results=[],mode=0,numParen=0,appendResult=function(){method&&('"'===definition.substr(0,1)&&(definition=definition.substr(1,definition.length-2)),definition&&args.push(definition),"-"===method.substr(0,1)&&(prefix_i=method.indexOf("-",1)+1)>0&&(prefix=method.substr(0,prefix_i),method=method.substr(prefix_i)),results.push({prefix:prefix,method:method.toLowerCase(),value:block,args:args})),args=[],method=prefix=definition=block=""};appendResult();for(var i=0,ii=value.length;ii>i;i++)if(c=value[i],!(0===mode&&whitespace.indexOf(c)>-1)){switch(c){case'"':quote?quote===c&&(quote=null):quote=c;break;case"(":if(quote)break;if(0===mode){mode=1,block+=c;continue}numParen++;break;case")":if(quote)break;if(1===mode){if(0===numParen){mode=0,block+=c,appendResult();continue}numParen--}break;case",":if(quote)break;if(0===mode){appendResult();continue}if(1===mode&&0===numParen&&!method.match(/^url$/i)){args.push(definition),definition="",block+=c;continue}}block+=c,0===mode?method+=c:definition+=c}return appendResult(),results},_html2canvas.Util.Bounds=function(el){var clientRect,bounds={};return el.getBoundingClientRect?(clientRect=el.getBoundingClientRect(),bounds.top=clientRect.top,bounds.bottom=clientRect.bottom||clientRect.top+clientRect.height,bounds.left=clientRect.left,bounds.width=clientRect.width||clientRect.right-clientRect.left,bounds.height=clientRect.height||clientRect.bottom-clientRect.top,bounds):void 0},_html2canvas.Util.getCSS=function(el,attribute,index){function toPX(attribute,val){var left,rsLeft=el.runtimeStyle&&el.runtimeStyle[attribute],style=el.style;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(val)&&/^-?\d/.test(val)&&(left=style.left,rsLeft&&(el.runtimeStyle.left=el.currentStyle.left),style.left="fontSize"===attribute?"1em":val||0,val=style.pixelLeft+"px",style.left=left,rsLeft&&(el.runtimeStyle.left=rsLeft)),/^(thin|medium|thick)$/i.test(val)?val:Math.round(parseFloat(val))+"px"}var val,isBackgroundSizePosition=attribute.match(/^background(Size|Position)$/);if(previousElement!==el&&(computedCSS=document.defaultView.getComputedStyle(el,null)),val=computedCSS[attribute],isBackgroundSizePosition)if(val=(val||"").split(","),val=val[index||0]||val[0]||"auto",val=_html2canvas.Util.trimText(val).split(" "),"backgroundSize"!==attribute||val[0]&&!val[0].match(/cover|contain|auto/)){if(val[0]=-1===val[0].indexOf("%")?toPX(attribute+"X",val[0]):val[0],val[1]===undefined){if("backgroundSize"===attribute)return val[1]="auto",val;val[1]=val[0]}val[1]=-1===val[1].indexOf("%")?toPX(attribute+"Y",val[1]):val[1]}else;else if(/border(Top|Bottom)(Left|Right)Radius/.test(attribute)){var arr=val.split(" ");arr.length<=1&&(arr[1]=arr[0]),arr[0]=parseInt(arr[0],10),arr[1]=parseInt(arr[1],10),val=arr}return val},_html2canvas.Util.resizeBounds=function(current_width,current_height,target_width,target_height,stretch_mode){var output_width,output_height,target_ratio=target_width/target_height,current_ratio=current_width/current_height;return stretch_mode&&"auto"!==stretch_mode?current_ratio>target_ratio^"contain"===stretch_mode?(output_height=target_height,output_width=target_height*current_ratio):(output_width=target_width,output_height=target_width/current_ratio):(output_width=target_width,output_height=target_height),{width:output_width,height:output_height}},_html2canvas.Util.BackgroundPosition=function(el,bounds,image,imageIndex,backgroundSize){var result=backgroundBoundsFactory("backgroundPosition",el,bounds,image,imageIndex,backgroundSize);return{left:result[0],top:result[1]}},_html2canvas.Util.BackgroundSize=function(el,bounds,image,imageIndex){var result=backgroundBoundsFactory("backgroundSize",el,bounds,image,imageIndex);return{width:result[0],height:result[1]}},_html2canvas.Util.Extend=function(options,defaults){for(var key in options)options.hasOwnProperty(key)&&(defaults[key]=options[key]);return defaults},_html2canvas.Util.Children=function(elem){var children;try{children=elem.nodeName&&"IFRAME"===elem.nodeName.toUpperCase()?elem.contentDocument||elem.contentWindow.document:function(array){var ret=[];return null!==array&&!function(first,second){var i=first.length,j=0;if("number"==typeof second.length)for(var l=second.length;l>j;j++)first[i++]=second[j];else for(;second[j]!==undefined;)first[i++]=second[j++];return first.length=i,first}(ret,array),ret}(elem.childNodes)}catch(ex){h2clog("html2canvas.Util.Children failed with exception: "+ex.message),children=[]}return children},_html2canvas.Util.Font=function(){var fontData={};return function(font,fontSize,doc){if(fontData[font+"-"+fontSize]!==undefined)return fontData[font+"-"+fontSize];var baseline,middle,metricsObj,container=doc.createElement("div"),img=doc.createElement("img"),span=doc.createElement("span"),sampleText="Hidden Text";return container.style.visibility="hidden",container.style.fontFamily=font,container.style.fontSize=fontSize,container.style.margin=0,container.style.padding=0,doc.body.appendChild(container),img.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=",img.width=1,img.height=1,img.style.margin=0,img.style.padding=0,img.style.verticalAlign="baseline",span.style.fontFamily=font,span.style.fontSize=fontSize,span.style.margin=0,span.style.padding=0,span.appendChild(doc.createTextNode(sampleText)),container.appendChild(span),container.appendChild(img),baseline=img.offsetTop-span.offsetTop+1,container.removeChild(span),container.appendChild(doc.createTextNode(sampleText)),container.style.lineHeight="normal",img.style.verticalAlign="super",middle=img.offsetTop-container.offsetTop+1,metricsObj={baseline:baseline,lineWidth:1,middle:middle},fontData[font+"-"+fontSize]=metricsObj,doc.body.removeChild(container),metricsObj}}(),function(){_html2canvas.Generate={};var reGradients=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];_html2canvas.Generate.parseGradient=function(css,bounds){var gradient,i,m1,stop,m2,m2Len,step,m3,tl,tr,br,bl,len=reGradients.length;for(i=0;len>i&&!(m1=css.match(reGradients[i]));i+=1);if(m1)switch(m1[1]){case"-webkit-linear-gradient":case"-o-linear-gradient":if(gradient={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},m2=m1[2].match(/\w+/g))for(m2Len=m2.length,i=0;m2Len>i;i+=1)switch(m2[i]){case"top":gradient.y0=0,gradient.y1=bounds.height;break;case"right":gradient.x0=bounds.width,gradient.x1=0;break;case"bottom":gradient.y0=bounds.height,gradient.y1=0;break;case"left":gradient.x0=0,gradient.x1=bounds.width}if(null===gradient.x0&&null===gradient.x1&&(gradient.x0=gradient.x1=bounds.width/2),null===gradient.y0&&null===gradient.y1&&(gradient.y0=gradient.y1=bounds.height/2),m2=m1[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(m2Len=m2.length,step=1/Math.max(m2Len-1,1),i=0;m2Len>i;i+=1)m3=m2[i].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),m3[2]?(stop=parseFloat(m3[2]),stop/="%"===m3[3]?100:bounds.width):stop=i*step,gradient.colorStops.push({color:m3[1],stop:stop});break;case"-webkit-gradient":if(gradient={type:"radial"===m1[2]?"circle":m1[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},m2=m1[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/),m2&&(gradient.x0=m2[1]*bounds.width/100,gradient.y0=m2[2]*bounds.height/100,gradient.x1=m2[3]*bounds.width/100,gradient.y1=m2[4]*bounds.height/100),m2=m1[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g))for(m2Len=m2.length,i=0;m2Len>i;i+=1)m3=m2[i].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),stop=parseFloat(m3[2]),"from"===m3[1]&&(stop=0),"to"===m3[1]&&(stop=1),gradient.colorStops.push({color:m3[3],stop:stop});break;case"-moz-linear-gradient":if(gradient={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]},m2=m1[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),m2&&(gradient.x0=m2[1]*bounds.width/100,gradient.y0=m2[2]*bounds.height/100,gradient.x1=bounds.width-gradient.x0,gradient.y1=bounds.height-gradient.y0),m2=m1[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g))for(m2Len=m2.length,step=1/Math.max(m2Len-1,1),i=0;m2Len>i;i+=1)m3=m2[i].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/),m3[2]?(stop=parseFloat(m3[2]),m3[3]&&(stop/=100)):stop=i*step,gradient.colorStops.push({color:m3[1],stop:stop});break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":if(gradient={type:"circle",x0:0,y0:0,x1:bounds.width,y1:bounds.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},m2=m1[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),m2&&(gradient.cx=m2[1]*bounds.width/100,gradient.cy=m2[2]*bounds.height/100),m2=m1[3].match(/\w+/),m3=m1[4].match(/[a-z\-]*/),m2&&m3)switch(m3[0]){case"farthest-corner":case"cover":case"":tl=Math.sqrt(Math.pow(gradient.cx,2)+Math.pow(gradient.cy,2)),tr=Math.sqrt(Math.pow(gradient.cx,2)+Math.pow(gradient.y1-gradient.cy,2)),br=Math.sqrt(Math.pow(gradient.x1-gradient.cx,2)+Math.pow(gradient.y1-gradient.cy,2)),bl=Math.sqrt(Math.pow(gradient.x1-gradient.cx,2)+Math.pow(gradient.cy,2)),gradient.rx=gradient.ry=Math.max(tl,tr,br,bl);break;case"closest-corner":tl=Math.sqrt(Math.pow(gradient.cx,2)+Math.pow(gradient.cy,2)),tr=Math.sqrt(Math.pow(gradient.cx,2)+Math.pow(gradient.y1-gradient.cy,2)),br=Math.sqrt(Math.pow(gradient.x1-gradient.cx,2)+Math.pow(gradient.y1-gradient.cy,2)),bl=Math.sqrt(Math.pow(gradient.x1-gradient.cx,2)+Math.pow(gradient.cy,2)),gradient.rx=gradient.ry=Math.min(tl,tr,br,bl);break;case"farthest-side":"circle"===m2[0]?gradient.rx=gradient.ry=Math.max(gradient.cx,gradient.cy,gradient.x1-gradient.cx,gradient.y1-gradient.cy):(gradient.type=m2[0],gradient.rx=Math.max(gradient.cx,gradient.x1-gradient.cx),gradient.ry=Math.max(gradient.cy,gradient.y1-gradient.cy));break;case"closest-side":case"contain":"circle"===m2[0]?gradient.rx=gradient.ry=Math.min(gradient.cx,gradient.cy,gradient.x1-gradient.cx,gradient.y1-gradient.cy):(gradient.type=m2[0],gradient.rx=Math.min(gradient.cx,gradient.x1-gradient.cx),gradient.ry=Math.min(gradient.cy,gradient.y1-gradient.cy))}if(m2=m1[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(m2Len=m2.length,step=1/Math.max(m2Len-1,1),i=0;m2Len>i;i+=1)m3=m2[i].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),m3[2]?(stop=parseFloat(m3[2]),stop/="%"===m3[3]?100:bounds.width):stop=i*step,gradient.colorStops.push({color:m3[1],stop:stop})}return gradient},_html2canvas.Generate.Gradient=function(src,bounds){if(0!==bounds.width&&0!==bounds.height){var gradient,grad,i,len,canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");if(canvas.width=bounds.width,canvas.height=bounds.height,gradient=_html2canvas.Generate.parseGradient(src,bounds))if("linear"===gradient.type){for(grad=ctx.createLinearGradient(gradient.x0,gradient.y0,gradient.x1,gradient.y1),i=0,len=gradient.colorStops.length;len>i;i+=1)try{grad.addColorStop(gradient.colorStops[i].stop,gradient.colorStops[i].color)}catch(e){h2clog(["failed to add color stop: ",e,"; tried to add: ",gradient.colorStops[i],"; stop: ",i,"; in: ",src])}ctx.fillStyle=grad,ctx.fillRect(0,0,bounds.width,bounds.height)}else if("circle"===gradient.type){for(grad=ctx.createRadialGradient(gradient.cx,gradient.cy,0,gradient.cx,gradient.cy,gradient.rx),i=0,len=gradient.colorStops.length;len>i;i+=1)try{grad.addColorStop(gradient.colorStops[i].stop,gradient.colorStops[i].color)}catch(e){h2clog(["failed to add color stop: ",e,"; tried to add: ",gradient.colorStops[i],"; stop: ",i,"; in: ",src])}ctx.fillStyle=grad,ctx.fillRect(0,0,bounds.width,bounds.height)}else if("ellipse"===gradient.type){var canvasRadial=document.createElement("canvas"),ctxRadial=canvasRadial.getContext("2d"),ri=Math.max(gradient.rx,gradient.ry),di=2*ri;for(canvasRadial.width=canvasRadial.height=di,grad=ctxRadial.createRadialGradient(gradient.rx,gradient.ry,0,gradient.rx,gradient.ry,ri),i=0,len=gradient.colorStops.length;len>i;i+=1)try{grad.addColorStop(gradient.colorStops[i].stop,gradient.colorStops[i].color)}catch(e){h2clog(["failed to add color stop: ",e,"; tried to add: ",gradient.colorStops[i],"; stop: ",i,"; in: ",src])}ctxRadial.fillStyle=grad,ctxRadial.fillRect(0,0,di,di),ctx.fillStyle=gradient.colorStops[i-1].color,ctx.fillRect(0,0,canvas.width,canvas.height),ctx.drawImage(canvasRadial,gradient.cx-gradient.rx,gradient.cy-gradient.ry,2*gradient.rx,2*gradient.ry)}return canvas}},_html2canvas.Generate.ListAlpha=function(number){var modulus,tmp="";do modulus=number%26,tmp=String.fromCharCode(modulus+64)+tmp,number/=26;while(26*number>26);return tmp},_html2canvas.Generate.ListRoman=function(number){var v,romanArray=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],decimal=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],roman="",len=romanArray.length;if(0>=number||number>=4e3)return number;for(v=0;len>v;v+=1)for(;number>=decimal[v];)number-=decimal[v],roman+=romanArray[v];return roman}}(),_html2canvas.Parse=function(images,options){function documentWidth(){return Math.max(Math.max(doc.body.scrollWidth,doc.documentElement.scrollWidth),Math.max(doc.body.offsetWidth,doc.documentElement.offsetWidth),Math.max(doc.body.clientWidth,doc.documentElement.clientWidth))}function documentHeight(){return Math.max(Math.max(doc.body.scrollHeight,doc.documentElement.scrollHeight),Math.max(doc.body.offsetHeight,doc.documentElement.offsetHeight),Math.max(doc.body.clientHeight,doc.documentElement.clientHeight))}function getCSSInt(element,attribute){var val=parseInt(getCSS(element,attribute),10);return isNaN(val)?0:val}function renderRect(ctx,x,y,w,h,bgcolor){"transparent"!==bgcolor&&(ctx.setVariable("fillStyle",bgcolor),ctx.fillRect(x,y,w,h),numDraws+=1)}function textTransform(text,transform){switch(transform){case"lowercase":return text.toLowerCase();case"capitalize":return text.replace(/(^|\s|:|-|\(|\))([a-z])/g,function(m,p1,p2){return m.length>0?p1+p2.toUpperCase():void 0});case"uppercase":return text.toUpperCase();default:return text}}function noLetterSpacing(letter_spacing){return/^(normal|none|0px)$/.test(letter_spacing)}function drawText(currentText,x,y,ctx){null!==currentText&&_html2canvas.Util.trimText(currentText).length>0&&(ctx.fillText(currentText,x,y),numDraws+=1)}function setTextVariables(ctx,el,text_decoration,color){var align=!1,bold=getCSS(el,"fontWeight"),family=getCSS(el,"fontFamily"),size=getCSS(el,"fontSize");switch(parseInt(bold,10)){case 401:bold="bold";break;case 400:bold="normal"}return ctx.setVariable("fillStyle",color),ctx.setVariable("font",[getCSS(el,"fontStyle"),getCSS(el,"fontVariant"),bold,size,family].join(" ")),ctx.setVariable("textAlign",align?"right":"left"),"none"!==text_decoration?_html2canvas.Util.Font(family,size,doc):void 0}function renderTextDecoration(ctx,text_decoration,bounds,metrics,color){switch(text_decoration){case"underline":renderRect(ctx,bounds.left,Math.round(bounds.top+metrics.baseline+metrics.lineWidth),bounds.width,1,color);break;case"overline":renderRect(ctx,bounds.left,Math.round(bounds.top),bounds.width,1,color);break;case"line-through":renderRect(ctx,bounds.left,Math.ceil(bounds.top+metrics.middle+metrics.lineWidth),bounds.width,1,color)}}function getTextBounds(state,text,textDecoration,isLast){var bounds;if(support.rangeBounds)("none"!==textDecoration||0!==_html2canvas.Util.trimText(text).length)&&(bounds=textRangeBounds(text,state.node,state.textOffset)),state.textOffset+=text.length;else if(state.node&&"string"==typeof state.node.nodeValue){var newTextNode=isLast?state.node.splitText(text.length):null;bounds=textWrapperBounds(state.node),state.node=newTextNode}return bounds}function textRangeBounds(text,textNode,textOffset){var range=doc.createRange();return range.setStart(textNode,textOffset),range.setEnd(textNode,textOffset+text.length),range.getBoundingClientRect()}function textWrapperBounds(oldTextNode){var parent=oldTextNode.parentNode,wrapElement=doc.createElement("wrapper"),backupText=oldTextNode.cloneNode(!0);wrapElement.appendChild(oldTextNode.cloneNode(!0)),parent.replaceChild(wrapElement,oldTextNode);var bounds=_html2canvas.Util.Bounds(wrapElement);return parent.replaceChild(backupText,wrapElement),bounds}function renderText(el,textNode,stack){var metrics,textList,ctx=stack.ctx,color=getCSS(el,"color"),textDecoration=getCSS(el,"textDecoration"),textAlign=getCSS(el,"textAlign"),state={node:textNode,textOffset:0};_html2canvas.Util.trimText(textNode.nodeValue).length>0&&(textNode.nodeValue=textTransform(textNode.nodeValue,getCSS(el,"textTransform")),textAlign=textAlign.replace(["-webkit-auto"],["auto"]),textList=textNode.nodeValue.split(!options.letterRendering&&/^(left|right|justify|auto)$/.test(textAlign)&&noLetterSpacing(getCSS(el,"letterSpacing"))?/(\b| )/:""),metrics=setTextVariables(ctx,el,textDecoration,color),options.chinese&&textList.forEach(function(word,index){/.*[\u4E00-\u9FA5].*$/.test(word)&&(word=word.split(""),word.unshift(index,1),textList.splice.apply(textList,word))}),textList.forEach(function(text,index){var bounds=getTextBounds(state,text,textDecoration,index<textList.length-1);bounds&&(drawText(text,bounds.left,bounds.bottom,ctx),renderTextDecoration(ctx,textDecoration,bounds,metrics,color))}))}function listPosition(element,val){var originalType,bounds,boundElement=doc.createElement("boundelement");return boundElement.style.display="inline",originalType=element.style.listStyleType,element.style.listStyleType="none",boundElement.appendChild(doc.createTextNode(val)),element.insertBefore(boundElement,element.firstChild),bounds=_html2canvas.Util.Bounds(boundElement),element.removeChild(boundElement),element.style.listStyleType=originalType,bounds}function elementIndex(el){var i=-1,count=1,childs=el.parentNode.childNodes;if(el.parentNode){for(;childs[++i]!==el;)1===childs[i].nodeType&&count++;return count}return-1}function listItemText(element,type){var text,currentIndex=elementIndex(element);switch(type){case"decimal":text=currentIndex;break;case"decimal-leading-zero":text=1===currentIndex.toString().length?currentIndex="0"+currentIndex.toString():currentIndex.toString();break;case"upper-roman":text=_html2canvas.Generate.ListRoman(currentIndex);break;case"lower-roman":text=_html2canvas.Generate.ListRoman(currentIndex).toLowerCase();break;case"lower-alpha":text=_html2canvas.Generate.ListAlpha(currentIndex).toLowerCase();break;case"upper-alpha":text=_html2canvas.Generate.ListAlpha(currentIndex)}return text+=". "}function renderListItem(element,stack,elBounds){var x,text,listBounds,ctx=stack.ctx,type=getCSS(element,"listStyleType");if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(type)){if(text=listItemText(element,type),listBounds=listPosition(element,text),setTextVariables(ctx,element,"none",getCSS(element,"color")),"inside"!==getCSS(element,"listStylePosition"))return;ctx.setVariable("textAlign","left"),x=elBounds.left,drawText(text,x,listBounds.bottom,ctx)}}function loadImage(src){var img=images[src];return img&&img.succeeded===!0?img.img:!1}function clipBounds(src,dst){var x=Math.max(src.left,dst.left),y=Math.max(src.top,dst.top),x2=Math.min(src.left+src.width,dst.left+dst.width),y2=Math.min(src.top+src.height,dst.top+dst.height);return{left:x,top:y,width:x2-x,height:y2-y}}function setZ(zIndex,parentZ){var newContext;return parentZ?"auto"!==zIndex?(newContext=h2czContext(zIndex),parentZ.children.push(newContext),newContext):parentZ:newContext=h2czContext(0)}function renderImage(ctx,element,image,bounds,borders){var paddingLeft=getCSSInt(element,"paddingLeft"),paddingTop=getCSSInt(element,"paddingTop"),paddingRight=getCSSInt(element,"paddingRight"),paddingBottom=getCSSInt(element,"paddingBottom");drawImage(ctx,image,0,0,image.width,image.height,bounds.left+paddingLeft+borders[3].width,bounds.top+paddingTop+borders[0].width,bounds.width-(borders[1].width+borders[3].width+paddingLeft+paddingRight),bounds.height-(borders[0].width+borders[2].width+paddingTop+paddingBottom))}function getBorderData(element){return["Top","Right","Bottom","Left"].map(function(side){return{width:getCSSInt(element,"border"+side+"Width"),color:getCSS(element,"border"+side+"Color")}})}function getBorderRadiusData(element){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(side){return getCSS(element,"border"+side+"Radius")})}function bezierCurve(start,startControl,endControl,end){var lerp=function(a,b,t){return{x:a.x+(b.x-a.x)*t,y:a.y+(b.y-a.y)*t}};return{start:start,startControl:startControl,endControl:endControl,end:end,subdivide:function(t){var ab=lerp(start,startControl,t),bc=lerp(startControl,endControl,t),cd=lerp(endControl,end,t),abbc=lerp(ab,bc,t),bccd=lerp(bc,cd,t),dest=lerp(abbc,bccd,t);return[bezierCurve(start,ab,abbc,dest),bezierCurve(dest,bccd,cd,end)]},curveTo:function(borderArgs){borderArgs.push(["bezierCurve",startControl.x,startControl.y,endControl.x,endControl.y,end.x,end.y])},curveToReversed:function(borderArgs){borderArgs.push(["bezierCurve",endControl.x,endControl.y,startControl.x,startControl.y,start.x,start.y])}}}function parseCorner(borderArgs,radius1,radius2,corner1,corner2,x,y){radius1[0]>0||radius1[1]>0?(borderArgs.push(["line",corner1[0].start.x,corner1[0].start.y]),corner1[0].curveTo(borderArgs),corner1[1].curveTo(borderArgs)):borderArgs.push(["line",x,y]),(radius2[0]>0||radius2[1]>0)&&borderArgs.push(["line",corner2[0].start.x,corner2[0].start.y])}function drawSide(borderData,radius1,radius2,outer1,inner1,outer2,inner2){var borderArgs=[];return radius1[0]>0||radius1[1]>0?(borderArgs.push(["line",outer1[1].start.x,outer1[1].start.y]),outer1[1].curveTo(borderArgs)):borderArgs.push(["line",borderData.c1[0],borderData.c1[1]]),radius2[0]>0||radius2[1]>0?(borderArgs.push(["line",outer2[0].start.x,outer2[0].start.y]),outer2[0].curveTo(borderArgs),borderArgs.push(["line",inner2[0].end.x,inner2[0].end.y]),inner2[0].curveToReversed(borderArgs)):(borderArgs.push(["line",borderData.c2[0],borderData.c2[1]]),borderArgs.push(["line",borderData.c3[0],borderData.c3[1]])),radius1[0]>0||radius1[1]>0?(borderArgs.push(["line",inner1[1].end.x,inner1[1].end.y]),inner1[1].curveToReversed(borderArgs)):borderArgs.push(["line",borderData.c4[0],borderData.c4[1]]),borderArgs}function calculateCurvePoints(bounds,borderRadius,borders){var x=bounds.left,y=bounds.top,width=bounds.width,height=bounds.height,tlh=borderRadius[0][0],tlv=borderRadius[0][1],trh=borderRadius[1][0],trv=borderRadius[1][1],brv=borderRadius[2][0],brh=borderRadius[2][1],blh=borderRadius[3][0],blv=borderRadius[3][1],topWidth=width-trh,rightHeight=height-brv,bottomWidth=width-brh,leftHeight=height-blv;return{topLeftOuter:getCurvePoints(x,y,tlh,tlv).topLeft.subdivide(.5),topLeftInner:getCurvePoints(x+borders[3].width,y+borders[0].width,Math.max(0,tlh-borders[3].width),Math.max(0,tlv-borders[0].width)).topLeft.subdivide(.5),topRightOuter:getCurvePoints(x+topWidth,y,trh,trv).topRight.subdivide(.5),topRightInner:getCurvePoints(x+Math.min(topWidth,width+borders[3].width),y+borders[0].width,topWidth>width+borders[3].width?0:trh-borders[3].width,trv-borders[0].width).topRight.subdivide(.5),bottomRightOuter:getCurvePoints(x+bottomWidth,y+rightHeight,brh,brv).bottomRight.subdivide(.5),bottomRightInner:getCurvePoints(x+Math.min(bottomWidth,width+borders[3].width),y+Math.min(rightHeight,height+borders[0].width),Math.max(0,brh-borders[1].width),Math.max(0,brv-borders[2].width)).bottomRight.subdivide(.5),bottomLeftOuter:getCurvePoints(x,y+leftHeight,blh,blv).bottomLeft.subdivide(.5),bottomLeftInner:getCurvePoints(x+borders[3].width,y+leftHeight,Math.max(0,blh-borders[3].width),Math.max(0,blv-borders[2].width)).bottomLeft.subdivide(.5)}}function getBorderClip(element,borderPoints,borders,radius,bounds){var backgroundClip=getCSS(element,"backgroundClip"),borderArgs=[];switch(backgroundClip){case"content-box":case"padding-box":parseCorner(borderArgs,radius[0],radius[1],borderPoints.topLeftInner,borderPoints.topRightInner,bounds.left+borders[3].width,bounds.top+borders[0].width),parseCorner(borderArgs,radius[1],radius[2],borderPoints.topRightInner,borderPoints.bottomRightInner,bounds.left+bounds.width-borders[1].width,bounds.top+borders[0].width),parseCorner(borderArgs,radius[2],radius[3],borderPoints.bottomRightInner,borderPoints.bottomLeftInner,bounds.left+bounds.width-borders[1].width,bounds.top+bounds.height-borders[2].width),parseCorner(borderArgs,radius[3],radius[0],borderPoints.bottomLeftInner,borderPoints.topLeftInner,bounds.left+borders[3].width,bounds.top+bounds.height-borders[2].width);break;default:parseCorner(borderArgs,radius[0],radius[1],borderPoints.topLeftOuter,borderPoints.topRightOuter,bounds.left,bounds.top),parseCorner(borderArgs,radius[1],radius[2],borderPoints.topRightOuter,borderPoints.bottomRightOuter,bounds.left+bounds.width,bounds.top),parseCorner(borderArgs,radius[2],radius[3],borderPoints.bottomRightOuter,borderPoints.bottomLeftOuter,bounds.left+bounds.width,bounds.top+bounds.height),parseCorner(borderArgs,radius[3],radius[0],borderPoints.bottomLeftOuter,borderPoints.topLeftOuter,bounds.left,bounds.top+bounds.height)}return borderArgs}function parseBorders(element,bounds,borders){var borderSide,bx,by,bw,bh,borderArgs,x=bounds.left,y=bounds.top,width=bounds.width,height=bounds.height,borderRadius=getBorderRadiusData(element),borderPoints=calculateCurvePoints(bounds,borderRadius,borders),borderData={clip:getBorderClip(element,borderPoints,borders,borderRadius,bounds),borders:[]};for(borderSide=0;4>borderSide;borderSide++)if(borders[borderSide].width>0){switch(bx=x,by=y,bw=width,bh=height-borders[2].width,borderSide){case 0:bh=borders[0].width,borderArgs=drawSide({c1:[bx,by],c2:[bx+bw,by],c3:[bx+bw-borders[1].width,by+bh],c4:[bx+borders[3].width,by+bh]},borderRadius[0],borderRadius[1],borderPoints.topLeftOuter,borderPoints.topLeftInner,borderPoints.topRightOuter,borderPoints.topRightInner);break;case 1:bx=x+width-borders[1].width,bw=borders[1].width,borderArgs=drawSide({c1:[bx+bw,by],c2:[bx+bw,by+bh+borders[2].width],c3:[bx,by+bh],c4:[bx,by+borders[0].width]},borderRadius[1],borderRadius[2],borderPoints.topRightOuter,borderPoints.topRightInner,borderPoints.bottomRightOuter,borderPoints.bottomRightInner);break;case 2:by=by+height-borders[2].width,bh=borders[2].width,borderArgs=drawSide({c1:[bx+bw,by+bh],c2:[bx,by+bh],c3:[bx+borders[3].width,by],c4:[bx+bw-borders[2].width,by]},borderRadius[2],borderRadius[3],borderPoints.bottomRightOuter,borderPoints.bottomRightInner,borderPoints.bottomLeftOuter,borderPoints.bottomLeftInner);break;case 3:bw=borders[3].width,borderArgs=drawSide({c1:[bx,by+bh+borders[2].width],c2:[bx,by],c3:[bx+bw,by+borders[0].width],c4:[bx+bw,by+bh]},borderRadius[3],borderRadius[0],borderPoints.bottomLeftOuter,borderPoints.bottomLeftInner,borderPoints.topLeftOuter,borderPoints.topLeftInner)}borderData.borders.push({args:borderArgs,color:borders[borderSide].color})}return borderData}function createShape(ctx,args){var shape=ctx.drawShape();return args.forEach(function(border,index){shape[0===index?"moveTo":border[0]+"To"].apply(null,border.slice(1))}),shape}function renderBorders(ctx,borderArgs,color){"transparent"!==color&&(ctx.setVariable("fillStyle",color),createShape(ctx,borderArgs),ctx.fill(),numDraws+=1)}function renderFormValue(el,bounds,stack){var textValue,textNode,valueWrap=doc.createElement("valuewrap"),cssPropertyArray=["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"];cssPropertyArray.forEach(function(property){try{valueWrap.style[property]=getCSS(el,property)
}catch(e){h2clog("html2canvas: Parse: Exception caught in renderFormValue: "+e.message)}}),valueWrap.style.borderColor="black",valueWrap.style.borderStyle="solid",valueWrap.style.display="block",valueWrap.style.position="absolute",(/^(submit|reset|button|text|password)$/.test(el.type)||"SELECT"===el.nodeName)&&(valueWrap.style.lineHeight=getCSS(el,"height")),valueWrap.style.top=bounds.top+"px",valueWrap.style.left=bounds.left+"px",textValue="SELECT"===el.nodeName?(el.options[el.selectedIndex]||0).text:el.value,textValue||(textValue=el.placeholder),textNode=doc.createTextNode(textValue),valueWrap.appendChild(textNode),body.appendChild(valueWrap),renderText(el,textNode,stack),body.removeChild(valueWrap)}function drawImage(ctx){ctx.drawImage.apply(ctx,Array.prototype.slice.call(arguments,1)),numDraws+=1}function getPseudoElement(el,which){var elStyle=window.getComputedStyle(el,which);if(elStyle&&elStyle.content&&"none"!==elStyle.content&&"-moz-alt-content"!==elStyle.content){var content=elStyle.content+"",first=content.substr(0,1);first===content.substr(content.length-1)&&first.match(/'|"/)&&(content=content.substr(1,content.length-2));var isImage="url"===content.substr(0,3),elps=document.createElement(isImage?"img":"span");return elps.className=pseudoHide+"-before "+pseudoHide+"-after",Object.keys(elStyle).filter(indexedProperty).forEach(function(prop){try{elps.style[prop]=elStyle[prop]}catch(e){h2clog(["Tried to assign readonly property ",prop,"Error:",e])}}),isImage?elps.src=_html2canvas.Util.parseBackgroundImage(content)[0].args[0]:elps.innerHTML=content,elps}}function indexedProperty(property){return isNaN(window.parseInt(property,10))}function injectPseudoElements(el,stack){var before=getPseudoElement(el,":before"),after=getPseudoElement(el,":after");(before||after)&&(before&&(el.className+=" "+pseudoHide+"-before",el.parentNode.insertBefore(before,el),parseElement(before,stack,!0),el.parentNode.removeChild(before),el.className=el.className.replace(pseudoHide+"-before","").trim()),after&&(el.className+=" "+pseudoHide+"-after",el.appendChild(after),parseElement(after,stack,!0),el.removeChild(after),el.className=el.className.replace(pseudoHide+"-after","").trim()))}function renderBackgroundRepeat(ctx,image,backgroundPosition,bounds){var offsetX=Math.round(bounds.left+backgroundPosition.left),offsetY=Math.round(bounds.top+backgroundPosition.top);ctx.createPattern(image),ctx.translate(offsetX,offsetY),ctx.fill(),ctx.translate(-offsetX,-offsetY)}function backgroundRepeatShape(ctx,image,backgroundPosition,bounds,left,top,width,height){var args=[];args.push(["line",Math.round(left),Math.round(top)]),args.push(["line",Math.round(left+width),Math.round(top)]),args.push(["line",Math.round(left+width),Math.round(height+top)]),args.push(["line",Math.round(left),Math.round(height+top)]),createShape(ctx,args),ctx.save(),ctx.clip(),renderBackgroundRepeat(ctx,image,backgroundPosition,bounds),ctx.restore()}function renderBackgroundColor(ctx,backgroundBounds,bgcolor){renderRect(ctx,backgroundBounds.left,backgroundBounds.top,backgroundBounds.width,backgroundBounds.height,bgcolor)}function renderBackgroundRepeating(el,bounds,ctx,image,imageIndex){var backgroundSize=_html2canvas.Util.BackgroundSize(el,bounds,image,imageIndex),backgroundPosition=_html2canvas.Util.BackgroundPosition(el,bounds,image,imageIndex,backgroundSize),backgroundRepeat=getCSS(el,"backgroundRepeat").split(",").map(function(value){return value.trim()});switch(image=resizeImage(image,backgroundSize),backgroundRepeat=backgroundRepeat[imageIndex]||backgroundRepeat[0]){case"repeat-x":backgroundRepeatShape(ctx,image,backgroundPosition,bounds,bounds.left,bounds.top+backgroundPosition.top,99999,image.height);break;case"repeat-y":backgroundRepeatShape(ctx,image,backgroundPosition,bounds,bounds.left+backgroundPosition.left,bounds.top,image.width,99999);break;case"no-repeat":backgroundRepeatShape(ctx,image,backgroundPosition,bounds,bounds.left+backgroundPosition.left,bounds.top+backgroundPosition.top,image.width,image.height);break;default:renderBackgroundRepeat(ctx,image,backgroundPosition,{top:bounds.top,left:bounds.left,width:image.width,height:image.height})}}function renderBackgroundImage(element,bounds,ctx){for(var image,backgroundImage=getCSS(element,"backgroundImage"),backgroundImages=_html2canvas.Util.parseBackgroundImage(backgroundImage),imageIndex=backgroundImages.length;imageIndex--;)if(backgroundImage=backgroundImages[imageIndex],backgroundImage.args&&0!==backgroundImage.args.length){var key="url"===backgroundImage.method?backgroundImage.args[0]:backgroundImage.value;image=loadImage(key),image?renderBackgroundRepeating(element,bounds,ctx,image,imageIndex):h2clog("html2canvas: Error loading background:",backgroundImage)}}function resizeImage(image,bounds){if(image.width===bounds.width&&image.height===bounds.height)return image;var ctx,canvas=doc.createElement("canvas");return canvas.width=bounds.width,canvas.height=bounds.height,ctx=canvas.getContext("2d"),drawImage(ctx,image,0,0,image.width,image.height,0,0,bounds.width,bounds.height),canvas}function setOpacity(ctx,element,parentStack){var opacity=getCSS(element,"opacity")*(parentStack?parentStack.opacity:1);return ctx.setVariable("globalAlpha",opacity),opacity}function createStack(element,parentStack,bounds){var ctx=h2cRenderContext(parentStack?bounds.width:documentWidth(),parentStack?bounds.height:documentHeight()),stack={ctx:ctx,zIndex:setZ(getCSS(element,"zIndex"),parentStack?parentStack.zIndex:null),opacity:setOpacity(ctx,element,parentStack),cssPosition:getCSS(element,"position"),borders:getBorderData(element),clip:parentStack&&parentStack.clip?_html2canvas.Util.Extend({},parentStack.clip):null};return options.useOverflow===!0&&/(hidden|scroll|auto)/.test(getCSS(element,"overflow"))===!0&&/(BODY)/i.test(element.nodeName)===!1&&(stack.clip=stack.clip?clipBounds(stack.clip,bounds):bounds),stack.zIndex.children.push(stack),stack}function getBackgroundBounds(borders,bounds,clip){var backgroundBounds={left:bounds.left+borders[3].width,top:bounds.top+borders[0].width,width:bounds.width-(borders[1].width+borders[3].width),height:bounds.height-(borders[0].width+borders[2].width)};return clip&&(backgroundBounds=clipBounds(backgroundBounds,clip)),backgroundBounds}function renderElement(element,parentStack,pseudoElement){var image,bounds=_html2canvas.Util.Bounds(element),bgcolor=ignoreElementsRegExp.test(element.nodeName)?"#efefef":getCSS(element,"backgroundColor"),stack=createStack(element,parentStack,bounds),borders=stack.borders,ctx=stack.ctx,backgroundBounds=getBackgroundBounds(borders,bounds,stack.clip),borderData=parseBorders(element,bounds,borders);switch(createShape(ctx,borderData.clip),ctx.save(),ctx.clip(),backgroundBounds.height>0&&backgroundBounds.width>0&&(renderBackgroundColor(ctx,bounds,bgcolor),renderBackgroundImage(element,backgroundBounds,ctx)),ctx.restore(),borderData.borders.forEach(function(border){renderBorders(ctx,border.args,border.color)}),pseudoElement||injectPseudoElements(element,stack),element.nodeName){case"IMG":(image=loadImage(element.getAttribute("src")))?renderImage(ctx,element,image,bounds,borders):h2clog("html2canvas: Error loading <img>:"+element.getAttribute("src"));break;case"INPUT":/^(text|url|email|submit|button|reset)$/.test(element.type)&&(element.value||element.placeholder).length>0&&renderFormValue(element,bounds,stack);break;case"TEXTAREA":(element.value||element.placeholder||"").length>0&&renderFormValue(element,bounds,stack);break;case"SELECT":(element.options||element.placeholder||"").length>0&&renderFormValue(element,bounds,stack);break;case"LI":renderListItem(element,stack,backgroundBounds);break;case"CANVAS":renderImage(ctx,element,element,bounds,borders)}return stack}function isElementVisible(element){return"none"!==getCSS(element,"display")&&"hidden"!==getCSS(element,"visibility")&&!element.hasAttribute("data-html2canvas-ignore")}function parseElement(el,stack,pseudoElement){isElementVisible(el)&&(stack=renderElement(el,stack,pseudoElement)||stack,ignoreElementsRegExp.test(el.nodeName)||_html2canvas.Util.Children(el).forEach(function(node){1===node.nodeType?parseElement(node,stack,pseudoElement):3===node.nodeType&&renderText(el,node,stack)}))}function svgDOMRender(body,stack){function parseDOM(el){var attr,a,alen,elm,i,children=_html2canvas.Util.Children(el),len=children.length;for(i=0;len>i;i+=1)if(elm=children[i],3===elm.nodeType)html+=elm.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;");else if(1===elm.nodeType&&!/^(script|meta|title)$/.test(elm.nodeName.toLowerCase())){if(html+="<"+elm.nodeName.toLowerCase(),elm.hasAttributes())for(attr=elm.attributes,alen=attr.length,a=0;alen>a;a+=1)html+=" "+attr[a].name+'="'+attr[a].value+'"';html+=">",parseDOM(elm),html+="</"+elm.nodeName.toLowerCase()+">"}}var img=new Image,docWidth=documentWidth(),docHeight=documentHeight(),html="";parseDOM(body),img.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='"+docWidth+"' height='"+docHeight+"'>","<foreignObject width='"+docWidth+"' height='"+docHeight+"'>","<html xmlns='http://www.w3.org/1999/xhtml' style='margin:0;'>",html.replace(/\#/g,"%23"),"</html>","</foreignObject>","</svg>"].join(""),img.onload=function(){stack.svgRender=img}}function init(){var stack=renderElement(element,null);return support.svgRendering&&svgDOMRender(document.documentElement,stack),Array.prototype.slice.call(element.children,0).forEach(function(childElement){parseElement(childElement,stack)}),stack.backgroundColor=getCSS(document.documentElement,"backgroundColor"),body.removeChild(hidePseudoElements),stack}var element=options.elements===undefined?document.body:options.elements[0],numDraws=0,doc=element.ownerDocument,support=_html2canvas.Util.Support(options,doc),ignoreElementsRegExp=new RegExp("("+options.ignoreElements+")"),body=doc.body,getCSS=_html2canvas.Util.getCSS,pseudoHide="___html2canvas___pseudoelement",hidePseudoElements=doc.createElement("style");hidePseudoElements.innerHTML="."+pseudoHide+'-before:before { content: "" !important; display: none !important; }.'+pseudoHide+'-after:after { content: "" !important; display: none !important; }',body.appendChild(hidePseudoElements),images=images||{};var getCurvePoints=function(kappa){return function(x,y,r1,r2){var ox=r1*kappa,oy=r2*kappa,xm=x+r1,ym=y+r2;return{topLeft:bezierCurve({x:x,y:ym},{x:x,y:ym-oy},{x:xm-ox,y:y},{x:xm,y:y}),topRight:bezierCurve({x:x,y:y},{x:x+ox,y:y},{x:xm,y:ym-oy},{x:xm,y:ym}),bottomRight:bezierCurve({x:xm,y:y},{x:xm,y:y+oy},{x:x+ox,y:ym},{x:x,y:ym}),bottomLeft:bezierCurve({x:xm,y:ym},{x:xm-ox,y:ym},{x:x,y:y+oy},{x:x,y:y})}}}(4*((Math.sqrt(2)-1)/3));return init()},_html2canvas.Preload=function(options){function isSameOrigin(url){link.href=url,link.href=link.href;var origin=link.protocol+link.host;return origin===pageOrigin}function start(){h2clog("html2canvas: start: images: "+images.numLoaded+" / "+images.numTotal+" (failed: "+images.numFailed+")"),!images.firstRun&&images.numLoaded>=images.numTotal&&(h2clog("Finished loading images: # "+images.numTotal+" (failed: "+images.numFailed+")"),"function"==typeof options.complete&&options.complete(images))}function proxyGetImage(url,img,imageObj){var callback_name,script,scriptUrl=options.proxy;link.href=url,url=link.href,callback_name="html2canvas_"+count++,imageObj.callbackname=callback_name,scriptUrl+=scriptUrl.indexOf("?")>-1?"&":"?",scriptUrl+="url="+encodeURIComponent(url)+"&callback="+callback_name,script=doc.createElement("script"),window[callback_name]=function(a){"error:"===a.substring(0,6)?(imageObj.succeeded=!1,images.numLoaded++,images.numFailed++,start()):(setImageLoadHandlers(img,imageObj),img.src=a),window[callback_name]=undefined;try{delete window[callback_name]}catch(ex){}script.parentNode.removeChild(script),script=null,delete imageObj.script,delete imageObj.callbackname},script.setAttribute("type","text/javascript"),script.setAttribute("src",scriptUrl),imageObj.script=script,window.document.body.appendChild(script)}function loadPseudoElement(element,type){var style=window.getComputedStyle(element,type),content=style.content;"url"===content.substr(0,3)&&methods.loadImage(_html2canvas.Util.parseBackgroundImage(content)[0].args[0]),loadBackgroundImages(style.backgroundImage,element)}function loadPseudoElementImages(element){loadPseudoElement(element,":before"),loadPseudoElement(element,":after")}function loadGradientImage(backgroundImage,bounds){var img=_html2canvas.Generate.Gradient(backgroundImage,bounds);img!==undefined&&(images[backgroundImage]={img:img,succeeded:!0},images.numTotal++,images.numLoaded++,start())}function invalidBackgrounds(background_image){return background_image&&background_image.method&&background_image.args&&background_image.args.length>0}function loadBackgroundImages(background_image,el){var bounds;_html2canvas.Util.parseBackgroundImage(background_image).filter(invalidBackgrounds).forEach(function(background_image){"url"===background_image.method?methods.loadImage(background_image.args[0]):background_image.method.match(/\-?gradient$/)&&(bounds===undefined&&(bounds=_html2canvas.Util.Bounds(el)),loadGradientImage(background_image.value,bounds))})}function getImages(el){var elNodeType=!1;try{_html2canvas.Util.Children(el).forEach(function(img){getImages(img)})}catch(e){}try{elNodeType=el.nodeType}catch(ex){elNodeType=!1,h2clog("html2canvas: failed to access some element's nodeType - Exception: "+ex.message)}if(1===elNodeType||elNodeType===undefined){loadPseudoElementImages(el);try{loadBackgroundImages(_html2canvas.Util.getCSS(el,"backgroundImage"),el)}catch(e){h2clog("html2canvas: failed to get background-image - Exception: "+e.message)}loadBackgroundImages(el)}}function setImageLoadHandlers(img,imageObj){img.onload=function(){imageObj.timer!==undefined&&window.clearTimeout(imageObj.timer),images.numLoaded++,imageObj.succeeded=!0,img.onerror=img.onload=null,start()},img.onerror=function(){if("anonymous"===img.crossOrigin&&(window.clearTimeout(imageObj.timer),options.proxy)){var src=img.src;return img=new Image,imageObj.img=img,img.src=src,void proxyGetImage(img.src,img,imageObj)}images.numLoaded++,images.numFailed++,imageObj.succeeded=!1,img.onerror=img.onload=null,start()}}var pageOrigin,methods,i,timeoutTimer,images={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},count=0,element=options.elements[0]||document.body,doc=element.ownerDocument,domImages=doc.images,imgLen=domImages.length,link=doc.createElement("a"),supportCORS=function(img){return img.crossOrigin!==undefined}(new Image);for(link.href=window.location.href,pageOrigin=link.protocol+link.host,methods={loadImage:function(src){var img,imageObj;src&&images[src]===undefined&&(img=new Image,src.match(/data:image\/.*;base64,/i)?(img.src=src.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),imageObj=images[src]={img:img},images.numTotal++,setImageLoadHandlers(img,imageObj)):isSameOrigin(src)||options.allowTaint===!0?(imageObj=images[src]={img:img},images.numTotal++,setImageLoadHandlers(img,imageObj),img.src=src):supportCORS&&!options.allowTaint&&options.useCORS?(img.crossOrigin="anonymous",imageObj=images[src]={img:img},images.numTotal++,setImageLoadHandlers(img,imageObj),img.src=src,img.customComplete=function(){this.img.complete?this.img.onerror():this.timer=window.setTimeout(this.img.customComplete,100)}.bind(imageObj),img.customComplete()):options.proxy&&(imageObj=images[src]={img:img},images.numTotal++,proxyGetImage(src,img,imageObj)))},cleanupDOM:function(cause){var img,src;if(!images.cleanupDone){h2clog(cause&&"string"==typeof cause?"html2canvas: Cleanup because: "+cause:"html2canvas: Cleanup after timeout: "+options.timeout+" ms.");for(src in images)if(images.hasOwnProperty(src)&&(img=images[src],"object"==typeof img&&img.callbackname&&img.succeeded===undefined)){window[img.callbackname]=undefined;try{delete window[img.callbackname]}catch(ex){}img.script&&img.script.parentNode&&(img.script.setAttribute("src","about:blank"),img.script.parentNode.removeChild(img.script)),images.numLoaded++,images.numFailed++,h2clog("html2canvas: Cleaned up failed img: '"+src+"' Steps: "+images.numLoaded+" / "+images.numTotal)}window.stop!==undefined?window.stop():document.execCommand!==undefined&&document.execCommand("Stop",!1),document.close!==undefined&&document.close(),images.cleanupDone=!0,cause&&"string"==typeof cause||start()}},renderingDone:function(){timeoutTimer&&window.clearTimeout(timeoutTimer)}},options.timeout>0&&(timeoutTimer=window.setTimeout(methods.cleanupDOM,options.timeout)),h2clog("html2canvas: Preload starts: finding background-images"),images.firstRun=!0,getImages(element),h2clog("html2canvas: Preload: Finding images"),i=0;imgLen>i;i+=1)methods.loadImage(domImages[i].getAttribute("src"));return images.firstRun=!1,h2clog("html2canvas: Preload: Done."),images.numTotal===images.numLoaded&&start(),methods},_html2canvas.Renderer=function(parseQueue,options){function createRenderQueue(parseQueue){var queue=[],sortZ=function(zStack){var subStacks=[],stackValues=[];zStack.children.forEach(function(stackChild){stackChild.children&&stackChild.children.length>0?(subStacks.push(stackChild),stackValues.push(stackChild.zindex)):queue.push(stackChild)}),stackValues.sort(function(a,b){return a-b}),stackValues.forEach(function(zValue){var index;subStacks.some(function(stack,i){return index=i,stack.zindex===zValue}),sortZ(subStacks.splice(index,1)[0])})};return sortZ(parseQueue.zIndex),queue}function getRenderer(rendererName){var renderer;if("string"==typeof options.renderer&&_html2canvas.Renderer[rendererName]!==undefined)renderer=_html2canvas.Renderer[rendererName](options);else{if("function"!=typeof rendererName)throw new Error("Unknown renderer");renderer=rendererName(options)}if("function"!=typeof renderer)throw new Error("Invalid renderer defined");return renderer}return getRenderer(options.renderer)(parseQueue,options,document,createRenderQueue(parseQueue),_html2canvas)},_html2canvas.Util.Support=function(options,doc){function supportSVGRendering(){var img=new Image,canvas=doc.createElement("canvas"),ctx=canvas.getContext===undefined?!1:canvas.getContext("2d");if(ctx===!1)return!1;canvas.width=canvas.height=10,img.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{ctx.drawImage(img,0,0),canvas.toDataURL()}catch(e){return!1}return h2clog("html2canvas: Parse: SVG powered rendering available"),!0}function supportRangeBounds(){var r,testElement,rangeBounds,rangeHeight,support=!1;return doc.createRange&&(r=doc.createRange(),r.getBoundingClientRect&&(testElement=doc.createElement("boundtest"),testElement.style.height="123px",testElement.style.display="block",doc.body.appendChild(testElement),r.selectNode(testElement),rangeBounds=r.getBoundingClientRect(),rangeHeight=rangeBounds.height,123===rangeHeight&&(support=!0),doc.body.removeChild(testElement))),support}return{rangeBounds:supportRangeBounds(),svgRendering:options.svgRendering&&supportSVGRendering()}},window.html2canvas=function(elements,opts){elements=elements.length?elements:[elements];var queue,canvas,options={logging:!1,elements:elements,background:"#fff",proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:"Canvas"};return options=_html2canvas.Util.Extend(opts,options),_html2canvas.logging=options.logging,options.complete=function(images){("function"!=typeof options.onpreloaded||options.onpreloaded(images)!==!1)&&(queue=_html2canvas.Parse(images,options),("function"!=typeof options.onparsed||options.onparsed(queue)!==!1)&&(canvas=_html2canvas.Renderer(queue,options),"function"==typeof options.onrendered&&options.onrendered(canvas)))},window.setTimeout(function(){_html2canvas.Preload(options)},0),{render:function(queue,opts){return _html2canvas.Renderer(queue,_html2canvas.Util.Extend(opts,options))},parse:function(images,opts){return _html2canvas.Parse(images,_html2canvas.Util.Extend(opts,options))},preload:function(opts){return _html2canvas.Preload(_html2canvas.Util.Extend(opts,options))},log:h2clog}},window.html2canvas.log=h2clog,window.html2canvas.Renderer={Canvas:undefined},_html2canvas.Renderer.Canvas=function(options){function createShape(ctx,args){ctx.beginPath(),args.forEach(function(arg){ctx[arg.name].apply(ctx,arg.arguments)}),ctx.closePath()}function safeImage(item){if(-1===safeImages.indexOf(item.arguments[0].src)){testctx.drawImage(item.arguments[0],0,0);try{testctx.getImageData(0,0,1,1)}catch(e){return testCanvas=doc.createElement("canvas"),testctx=testCanvas.getContext("2d"),!1}safeImages.push(item.arguments[0].src)}return!0}function isTransparent(backgroundColor){return"transparent"===backgroundColor||"rgba(0, 0, 0, 0)"===backgroundColor}function renderItem(ctx,item){switch(item.type){case"variable":ctx[item.name]=item.arguments;break;case"function":if("createPattern"===item.name){if(item.arguments[0].width>0&&item.arguments[0].height>0)try{ctx.fillStyle=ctx.createPattern(item.arguments[0],"repeat")}catch(e){h2clog("html2canvas: Renderer: Error creating pattern",e.message)}}else"drawShape"===item.name?createShape(ctx,item.arguments):"drawImage"===item.name?item.arguments[8]>0&&item.arguments[7]>0&&(!options.taintTest||options.taintTest&&safeImage(item))&&ctx.drawImage.apply(ctx,item.arguments):ctx[item.name].apply(ctx,item.arguments)}}options=options||{};var doc=document,safeImages=[],testCanvas=document.createElement("canvas"),testctx=testCanvas.getContext("2d"),canvas=options.canvas||doc.createElement("canvas");return function(zStack,options,doc,queue,_html2canvas){var storageContext,i,queueLen,newCanvas,bounds,fstyle,ctx=canvas.getContext("2d");if(canvas.width=canvas.style.width=options.width||zStack.ctx.width,canvas.height=canvas.style.height=options.height||zStack.ctx.height,fstyle=ctx.fillStyle,ctx.fillStyle=isTransparent(zStack.backgroundColor)&&options.background!==undefined?options.background:zStack.backgroundColor,ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle=fstyle,options.svgRendering&&zStack.svgRender!==undefined)ctx.drawImage(zStack.svgRender,0,0);else for(i=0,queueLen=queue.length;queueLen>i;i+=1)storageContext=queue.splice(0,1)[0],storageContext.canvasPosition=storageContext.canvasPosition||{},ctx.textBaseline="bottom",storageContext.clip&&(ctx.save(),ctx.beginPath(),ctx.rect(storageContext.clip.left,storageContext.clip.top,storageContext.clip.width,storageContext.clip.height),ctx.clip()),storageContext.ctx.storage&&storageContext.ctx.storage.forEach(renderItem.bind(null,ctx)),storageContext.clip&&ctx.restore();return h2clog("html2canvas: Renderer: Canvas renderer done - returning canvas obj"),queueLen=options.elements.length,1===queueLen&&"object"==typeof options.elements[0]&&"BODY"!==options.elements[0].nodeName?(bounds=_html2canvas.Util.Bounds(options.elements[0]),newCanvas=doc.createElement("canvas"),newCanvas.width=bounds.width,newCanvas.height=bounds.height,ctx=newCanvas.getContext("2d"),ctx.drawImage(canvas,bounds.left,bounds.top,bounds.width,bounds.height,0,0,bounds.width,bounds.height),canvas=null,newCanvas):canvas}}}(window,document);var io="undefined"==typeof module?{}:module.exports;!function(){!function(exports,global){var io=exports;io.version="0.9.16",io.protocol=1,io.transports=[],io.j=[],io.sockets={},io.connect=function(host,details){var uuri,socket,uri=io.util.parseUri(host);global&&global.location&&(uri.protocol=uri.protocol||global.location.protocol.slice(0,-1),uri.host=uri.host||(global.document?global.document.domain:global.location.hostname),uri.port=uri.port||global.location.port),uuri=io.util.uniqueUri(uri);var options={host:uri.host,secure:"https"==uri.protocol,port:uri.port||("https"==uri.protocol?443:80),query:uri.query||""};return io.util.merge(options,details),(options["force new connection"]||!io.sockets[uuri])&&(socket=new io.Socket(options)),!options["force new connection"]&&socket&&(io.sockets[uuri]=socket),socket=socket||io.sockets[uuri],socket.of(uri.path.length>1?uri.path:"")}}("object"==typeof module?module.exports:this.io={},this),function(exports,global){var util=exports.util={},re=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];util.parseUri=function(str){for(var m=re.exec(str||""),uri={},i=14;i--;)uri[parts[i]]=m[i]||"";return uri},util.uniqueUri=function(uri){var protocol=uri.protocol,host=uri.host,port=uri.port;return"document"in global?(host=host||document.domain,port=port||("https"==protocol&&"https:"!==document.location.protocol?443:document.location.port)):(host=host||"localhost",port||"https"!=protocol||(port=443)),(protocol||"http")+"://"+host+":"+(port||80)},util.query=function(base,addition){var query=util.chunkQuery(base||""),components=[];util.merge(query,util.chunkQuery(addition||""));for(var part in query)query.hasOwnProperty(part)&&components.push(part+"="+query[part]);return components.length?"?"+components.join("&"):""},util.chunkQuery=function(qs){for(var kv,query={},params=qs.split("&"),i=0,l=params.length;l>i;++i)kv=params[i].split("="),kv[0]&&(query[kv[0]]=kv[1]);return query};var pageLoaded=!1;util.load=function(fn){return"document"in global&&"complete"===document.readyState||pageLoaded?fn():void util.on(global,"load",fn,!1)},util.on=function(element,event,fn,capture){element.attachEvent?element.attachEvent("on"+event,fn):element.addEventListener&&element.addEventListener(event,fn,capture)},util.request=function(xdomain){if(xdomain&&"undefined"!=typeof XDomainRequest&&!util.ua.hasCORS)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!xdomain||util.ua.hasCORS))return new XMLHttpRequest;if(!xdomain)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}return null},"undefined"!=typeof window&&util.load(function(){pageLoaded=!0}),util.defer=function(fn){return util.ua.webkit&&"undefined"==typeof importScripts?void util.load(function(){setTimeout(fn,100)}):fn()},util.merge=function(target,additional,deep,lastseen){var prop,seen=lastseen||[],depth="undefined"==typeof deep?2:deep;for(prop in additional)additional.hasOwnProperty(prop)&&util.indexOf(seen,prop)<0&&("object"==typeof target[prop]&&depth?util.merge(target[prop],additional[prop],depth-1,seen):(target[prop]=additional[prop],seen.push(additional[prop])));return target},util.mixin=function(ctor,ctor2){util.merge(ctor.prototype,ctor2.prototype)},util.inherit=function(ctor,ctor2){function f(){}f.prototype=ctor2.prototype,ctor.prototype=new f},util.isArray=Array.isArray||function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},util.intersect=function(arr,arr2){for(var ret=[],longest=arr.length>arr2.length?arr:arr2,shortest=arr.length>arr2.length?arr2:arr,i=0,l=shortest.length;l>i;i++)~util.indexOf(longest,shortest[i])&&ret.push(shortest[i]);return ret},util.indexOf=function(arr,o,i){for(var j=arr.length,i=0>i?0>i+j?0:i+j:i||0;j>i&&arr[i]!==o;i++);return i>=j?-1:i},util.toArray=function(enu){for(var arr=[],i=0,l=enu.length;l>i;i++)arr.push(enu[i]);return arr},util.ua={},util.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var a=new XMLHttpRequest}catch(e){return!1}return void 0!=a.withCredentials}(),util.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),util.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(exports,io){function EventEmitter(){}exports.EventEmitter=EventEmitter,EventEmitter.prototype.on=function(name,fn){return this.$events||(this.$events={}),this.$events[name]?io.util.isArray(this.$events[name])?this.$events[name].push(fn):this.$events[name]=[this.$events[name],fn]:this.$events[name]=fn,this},EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.once=function(name,fn){function on(){self.removeListener(name,on),fn.apply(this,arguments)}var self=this;return on.listener=fn,this.on(name,on),this},EventEmitter.prototype.removeListener=function(name,fn){if(this.$events&&this.$events[name]){var list=this.$events[name];if(io.util.isArray(list)){for(var pos=-1,i=0,l=list.length;l>i;i++)if(list[i]===fn||list[i].listener&&list[i].listener===fn){pos=i;break}if(0>pos)return this;list.splice(pos,1),list.length||delete this.$events[name]}else(list===fn||list.listener&&list.listener===fn)&&delete this.$events[name]}return this},EventEmitter.prototype.removeAllListeners=function(name){return void 0===name?(this.$events={},this):(this.$events&&this.$events[name]&&(this.$events[name]=null),this)},EventEmitter.prototype.listeners=function(name){return this.$events||(this.$events={}),this.$events[name]||(this.$events[name]=[]),io.util.isArray(this.$events[name])||(this.$events[name]=[this.$events[name]]),this.$events[name]},EventEmitter.prototype.emit=function(name){if(!this.$events)return!1;var handler=this.$events[name];if(!handler)return!1;var args=Array.prototype.slice.call(arguments,1);if("function"==typeof handler)handler.apply(this,args);else{if(!io.util.isArray(handler))return!1;for(var listeners=handler.slice(),i=0,l=listeners.length;l>i;i++)listeners[i].apply(this,args)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){"use strict";function f(n){return 10>n?"0"+n:n}function date(d){return isFinite(d.valueOf())?d.getUTCFullYear()+"-"+f(d.getUTCMonth()+1)+"-"+f(d.getUTCDate())+"T"+f(d.getUTCHours())+":"+f(d.getUTCMinutes())+":"+f(d.getUTCSeconds())+"Z":null}function quote(string){return escapable.lastIndex=0,escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return"string"==typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,partial,mind=gap,value=holder[key];switch(value instanceof Date&&(value=date(key)),"function"==typeof rep&&(value=rep.call(holder,key,value)),typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value)return"null";if(gap+=indent,partial=[],"[object Array]"===Object.prototype.toString.apply(value)){for(length=value.length,i=0;length>i;i+=1)partial[i]=str(i,value)||"null";return v=0===partial.length?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]",gap=mind,v}if(rep&&"object"==typeof rep)for(length=rep.length,i=0;length>i;i+=1)"string"==typeof rep[i]&&(k=rep[i],v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));else for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));return v=0===partial.length?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}",gap=mind,v}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(value,replacer,space){var i;if(gap="",indent="","number"==typeof space)for(i=0;space>i;i+=1)indent+=" ";else"string"==typeof space&&(indent=space);if(rep=replacer,replacer&&"function"!=typeof replacer&&("object"!=typeof replacer||"number"!=typeof replacer.length))throw new Error("JSON.stringify");
return str("",{"":value})},JSON.parse=function(text,reviver){function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(exports,io){var parser=exports.parser={},packets=parser.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],reasons=parser.reasons=["transport not supported","client not handshaken","unauthorized"],advice=parser.advice=["reconnect"],JSON=io.JSON,indexOf=io.util.indexOf;parser.encodePacket=function(packet){var type=indexOf(packets,packet.type),id=packet.id||"",endpoint=packet.endpoint||"",ack=packet.ack,data=null;switch(packet.type){case"error":var reason=packet.reason?indexOf(reasons,packet.reason):"",adv=packet.advice?indexOf(advice,packet.advice):"";(""!==reason||""!==adv)&&(data=reason+(""!==adv?"+"+adv:""));break;case"message":""!==packet.data&&(data=packet.data);break;case"event":var ev={name:packet.name};packet.args&&packet.args.length&&(ev.args=packet.args),data=JSON.stringify(ev);break;case"json":data=JSON.stringify(packet.data);break;case"connect":packet.qs&&(data=packet.qs);break;case"ack":data=packet.ackId+(packet.args&&packet.args.length?"+"+JSON.stringify(packet.args):"")}var encoded=[type,id+("data"==ack?"+":""),endpoint];return null!==data&&void 0!==data&&encoded.push(data),encoded.join(":")},parser.encodePayload=function(packets){var decoded="";if(1==packets.length)return packets[0];for(var i=0,l=packets.length;l>i;i++){var packet=packets[i];decoded+="�"+packet.length+"�"+packets[i]}return decoded};var regexp=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;parser.decodePacket=function(data){var pieces=data.match(regexp);if(!pieces)return{};var id=pieces[2]||"",data=pieces[5]||"",packet={type:packets[pieces[1]],endpoint:pieces[4]||""};switch(id&&(packet.id=id,packet.ack=pieces[3]?"data":!0),packet.type){case"error":var pieces=data.split("+");packet.reason=reasons[pieces[0]]||"",packet.advice=advice[pieces[1]]||"";break;case"message":packet.data=data||"";break;case"event":try{var opts=JSON.parse(data);packet.name=opts.name,packet.args=opts.args}catch(e){}packet.args=packet.args||[];break;case"json":try{packet.data=JSON.parse(data)}catch(e){}break;case"connect":packet.qs=data||"";break;case"ack":var pieces=data.match(/^([0-9]+)(\+)?(.*)/);if(pieces&&(packet.ackId=pieces[1],packet.args=[],pieces[3]))try{packet.args=pieces[3]?JSON.parse(pieces[3]):[]}catch(e){}break;case"disconnect":case"heartbeat":}return packet},parser.decodePayload=function(data){if("�"==data.charAt(0)){for(var ret=[],i=1,length="";i<data.length;i++)"�"==data.charAt(i)?(ret.push(parser.decodePacket(data.substr(i+1).substr(0,length))),i+=Number(length)+1,length=""):length+=data.charAt(i);return ret}return[parser.decodePacket(data)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,io){function Transport(socket,sessid){this.socket=socket,this.sessid=sessid}exports.Transport=Transport,io.util.mixin(Transport,io.EventEmitter),Transport.prototype.heartbeats=function(){return!0},Transport.prototype.onData=function(data){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==data){var msgs=io.parser.decodePayload(data);if(msgs&&msgs.length)for(var i=0,l=msgs.length;l>i;i++)this.onPacket(msgs[i])}return this},Transport.prototype.onPacket=function(packet){return this.socket.setHeartbeatTimeout(),"heartbeat"==packet.type?this.onHeartbeat():("connect"==packet.type&&""==packet.endpoint&&this.onConnect(),"error"==packet.type&&"reconnect"==packet.advice&&(this.isOpen=!1),this.socket.onPacket(packet),this)},Transport.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var self=this;this.closeTimeout=setTimeout(function(){self.onDisconnect()},this.socket.closeTimeout)}},Transport.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},Transport.prototype.onConnect=function(){return this.socket.onConnect(),this},Transport.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},Transport.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},Transport.prototype.packet=function(packet){this.send(io.parser.encodePacket(packet))},Transport.prototype.onHeartbeat=function(){this.packet({type:"heartbeat"})},Transport.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},Transport.prototype.onClose=function(){this.isOpen=!1,this.socket.onClose(),this.onDisconnect()},Transport.prototype.prepareUrl=function(){var options=this.socket.options;return this.scheme()+"://"+options.host+":"+options.port+"/"+options.resource+"/"+io.protocol+"/"+this.name+"/"+this.sessid},Transport.prototype.ready=function(socket,fn){fn.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,io,global){function Socket(options){if(this.options={port:80,secure:!1,document:"document"in global?document:!1,resource:"socket.io",transports:io.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},io.util.merge(this.options,options),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||io.util.ua.hasCORS)){var self=this;io.util.on(global,"beforeunload",function(){self.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function empty(){}exports.Socket=Socket,io.util.mixin(Socket,io.EventEmitter),Socket.prototype.of=function(name){return this.namespaces[name]||(this.namespaces[name]=new io.SocketNamespace(this,name),""!==name&&this.namespaces[name].packet({type:"connect"})),this.namespaces[name]},Socket.prototype.publish=function(){this.emit.apply(this,arguments);var nsp;for(var i in this.namespaces)this.namespaces.hasOwnProperty(i)&&(nsp=this.of(i),nsp.$emit.apply(nsp,arguments))},Socket.prototype.handshake=function(fn){function complete(data){data instanceof Error?(self.connecting=!1,self.onError(data.message)):fn.apply(null,data.split(":"))}var self=this,options=this.options,url=["http"+(options.secure?"s":"")+":/",options.host+":"+options.port,options.resource,io.protocol,io.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!io.util.ua.hasCORS){var insertAt=document.getElementsByTagName("script")[0],script=document.createElement("script");script.src=url+"&jsonp="+io.j.length,insertAt.parentNode.insertBefore(script,insertAt),io.j.push(function(data){complete(data),script.parentNode.removeChild(script)})}else{var xhr=io.util.request();xhr.open("GET",url,!0),this.isXDomain()&&(xhr.withCredentials=!0),xhr.onreadystatechange=function(){4==xhr.readyState&&(xhr.onreadystatechange=empty,200==xhr.status?complete(xhr.responseText):403==xhr.status?self.onError(xhr.responseText):(self.connecting=!1,!self.reconnecting&&self.onError(xhr.responseText)))},xhr.send(null)}},Socket.prototype.getTransport=function(override){for(var transport,transports=override||this.transports,i=0;transport=transports[i];i++)if(io.Transport[transport]&&io.Transport[transport].check(this)&&(!this.isXDomain()||io.Transport[transport].xdomainCheck(this)))return new io.Transport[transport](this,this.sessionid);return null},Socket.prototype.connect=function(fn){if(this.connecting)return this;var self=this;return self.connecting=!0,this.handshake(function(sid,heartbeat,close,transports){function connect(transports){return self.transport&&self.transport.clearTimeouts(),self.transport=self.getTransport(transports),self.transport?void self.transport.ready(self,function(){self.connecting=!0,self.publish("connecting",self.transport.name),self.transport.open(),self.options["connect timeout"]&&(self.connectTimeoutTimer=setTimeout(function(){if(!self.connected&&(self.connecting=!1,self.options["try multiple transports"])){for(var remaining=self.transports;remaining.length>0&&remaining.splice(0,1)[0]!=self.transport.name;);remaining.length?connect(remaining):self.publish("connect_failed")}},self.options["connect timeout"]))}):self.publish("connect_failed")}self.sessionid=sid,self.closeTimeout=1e3*close,self.heartbeatTimeout=1e3*heartbeat,self.transports||(self.transports=self.origTransports=transports?io.util.intersect(transports.split(","),self.options.transports):self.options.transports),self.setHeartbeatTimeout(),connect(self.transports),self.once("connect",function(){clearTimeout(self.connectTimeoutTimer),fn&&"function"==typeof fn&&fn()})}),this},Socket.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var self=this;this.heartbeatTimeoutTimer=setTimeout(function(){self.transport.onClose()},this.heartbeatTimeout)}},Socket.prototype.packet=function(data){return this.connected&&!this.doBuffer?this.transport.packet(data):this.buffer.push(data),this},Socket.prototype.setBuffer=function(v){this.doBuffer=v,!v&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},Socket.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},Socket.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},Socket.prototype.disconnectSync=function(){var xhr=io.util.request(),uri=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,io.protocol,"",this.sessionid].join("/")+"/?disconnect=1";xhr.open("GET",uri,!1),xhr.send(null),this.onDisconnect("booted")},Socket.prototype.isXDomain=function(){var port=global.location.port||("https:"==global.location.protocol?443:80);return this.options.host!==global.location.hostname||this.options.port!=port},Socket.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},Socket.prototype.onOpen=function(){this.open=!0},Socket.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},Socket.prototype.onPacket=function(packet){this.of(packet.endpoint).onPacket(packet)},Socket.prototype.onError=function(err){err&&err.advice&&"reconnect"===err.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",err&&err.reason?err.reason:err)},Socket.prototype.onDisconnect=function(reason){var wasConnected=this.connected,wasConnecting=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(wasConnected||wasConnecting)&&(this.transport.close(),this.transport.clearTimeouts(),wasConnected&&(this.publish("disconnect",reason),"booted"!=reason&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},Socket.prototype.reconnect=function(){function reset(){if(self.connected){for(var i in self.namespaces)self.namespaces.hasOwnProperty(i)&&""!==i&&self.namespaces[i].packet({type:"connect"});self.publish("reconnect",self.transport.name,self.reconnectionAttempts)}clearTimeout(self.reconnectionTimer),self.removeListener("connect_failed",maybeReconnect),self.removeListener("connect",maybeReconnect),self.reconnecting=!1,delete self.reconnectionAttempts,delete self.reconnectionDelay,delete self.reconnectionTimer,delete self.redoTransports,self.options["try multiple transports"]=tryMultiple}function maybeReconnect(){return self.reconnecting?self.connected?reset():self.connecting&&self.reconnecting?self.reconnectionTimer=setTimeout(maybeReconnect,1e3):void(self.reconnectionAttempts++>=maxAttempts?self.redoTransports?(self.publish("reconnect_failed"),reset()):(self.on("connect_failed",maybeReconnect),self.options["try multiple transports"]=!0,self.transports=self.origTransports,self.transport=self.getTransport(),self.redoTransports=!0,self.connect()):(self.reconnectionDelay<limit&&(self.reconnectionDelay*=2),self.connect(),self.publish("reconnecting",self.reconnectionDelay,self.reconnectionAttempts),self.reconnectionTimer=setTimeout(maybeReconnect,self.reconnectionDelay))):void 0}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var self=this,maxAttempts=this.options["max reconnection attempts"],tryMultiple=this.options["try multiple transports"],limit=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(maybeReconnect,this.reconnectionDelay),this.on("connect",maybeReconnect)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(exports,io){function SocketNamespace(socket,name){this.socket=socket,this.name=name||"",this.flags={},this.json=new Flag(this,"json"),this.ackPackets=0,this.acks={}}function Flag(nsp,name){this.namespace=nsp,this.name=name}exports.SocketNamespace=SocketNamespace,io.util.mixin(SocketNamespace,io.EventEmitter),SocketNamespace.prototype.$emit=io.EventEmitter.prototype.emit,SocketNamespace.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},SocketNamespace.prototype.packet=function(packet){return packet.endpoint=this.name,this.socket.packet(packet),this.flags={},this},SocketNamespace.prototype.send=function(data,fn){var packet={type:this.flags.json?"json":"message",data:data};return"function"==typeof fn&&(packet.id=++this.ackPackets,packet.ack=!0,this.acks[packet.id]=fn),this.packet(packet)},SocketNamespace.prototype.emit=function(name){var args=Array.prototype.slice.call(arguments,1),lastArg=args[args.length-1],packet={type:"event",name:name};return"function"==typeof lastArg&&(packet.id=++this.ackPackets,packet.ack="data",this.acks[packet.id]=lastArg,args=args.slice(0,args.length-1)),packet.args=args,this.packet(packet)},SocketNamespace.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},SocketNamespace.prototype.onPacket=function(packet){function ack(){self.packet({type:"ack",args:io.util.toArray(arguments),ackId:packet.id})}var self=this;switch(packet.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(packet.reason||"booted"):this.$emit("disconnect",packet.reason);break;case"message":case"json":var params=["message",packet.data];"data"==packet.ack?params.push(ack):packet.ack&&this.packet({type:"ack",ackId:packet.id}),this.$emit.apply(this,params);break;case"event":var params=[packet.name].concat(packet.args);"data"==packet.ack&&params.push(ack),this.$emit.apply(this,params);break;case"ack":this.acks[packet.ackId]&&(this.acks[packet.ackId].apply(this,packet.args),delete this.acks[packet.ackId]);break;case"error":packet.advice?this.socket.onError(packet):"unauthorized"==packet.reason?this.$emit("connect_failed",packet.reason):this.$emit("error",packet.reason)}},Flag.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},Flag.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,io,global){function WS(){io.Transport.apply(this,arguments)}exports.websocket=WS,io.util.inherit(WS,io.Transport),WS.prototype.name="websocket",WS.prototype.open=function(){var Socket,query=io.util.query(this.socket.options.query),self=this;return Socket||(Socket=global.MozWebSocket||global.WebSocket),this.websocket=new Socket(this.prepareUrl()+query),this.websocket.onopen=function(){self.onOpen(),self.socket.setBuffer(!1)},this.websocket.onmessage=function(ev){self.onData(ev.data)},this.websocket.onclose=function(){self.onClose(),self.socket.setBuffer(!0)},this.websocket.onerror=function(e){self.onError(e)},this},WS.prototype.send=io.util.ua.iDevice?function(data){var self=this;return setTimeout(function(){self.websocket.send(data)},0),this}:function(data){return this.websocket.send(data),this},WS.prototype.payload=function(arr){for(var i=0,l=arr.length;l>i;i++)this.packet(arr[i]);return this},WS.prototype.close=function(){return this.websocket.close(),this},WS.prototype.onError=function(e){this.socket.onError(e)},WS.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},WS.check=function(){return"WebSocket"in global&&!("__addTask"in WebSocket)||"MozWebSocket"in global},WS.xdomainCheck=function(){return!0},io.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(exports,io,global){function XHR(socket){socket&&(io.Transport.apply(this,arguments),this.sendBuffer=[])}function empty(){}exports.XHR=XHR,io.util.inherit(XHR,io.Transport),XHR.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},XHR.prototype.payload=function(payload){for(var msgs=[],i=0,l=payload.length;l>i;i++)msgs.push(io.parser.encodePacket(payload[i]));this.send(io.parser.encodePayload(msgs))},XHR.prototype.send=function(data){return this.post(data),this},XHR.prototype.post=function(data){function stateChange(){4==this.readyState&&(this.onreadystatechange=empty,self.posting=!1,200==this.status?self.socket.setBuffer(!1):self.onClose())}function onload(){this.onload=empty,self.socket.setBuffer(!1)}var self=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),global.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=onload:this.sendXHR.onreadystatechange=stateChange,this.sendXHR.send(data)},XHR.prototype.close=function(){return this.onClose(),this},XHR.prototype.request=function(method){var req=io.util.request(this.socket.isXDomain()),query=io.util.query(this.socket.options.query,"t="+ +new Date);if(req.open(method||"GET",this.prepareUrl()+query,!0),"POST"==method)try{req.setRequestHeader?req.setRequestHeader("Content-type","text/plain;charset=UTF-8"):req.contentType="text/plain"}catch(e){}return req},XHR.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},XHR.check=function(socket,xdomain){try{var request=io.util.request(xdomain),usesXDomReq=global.XDomainRequest&&request instanceof XDomainRequest,socketProtocol=socket&&socket.options&&socket.options.secure?"https:":"http:",isXProtocol=global.location&&socketProtocol!=global.location.protocol;if(request&&(!usesXDomReq||!isXProtocol))return!0}catch(e){}return!1},XHR.xdomainCheck=function(socket){return XHR.check(socket,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(exports,io){function HTMLFile(){io.Transport.XHR.apply(this,arguments)}exports.htmlfile=HTMLFile,io.util.inherit(HTMLFile,io.Transport.XHR),HTMLFile.prototype.name="htmlfile",HTMLFile.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var iframeC=this.doc.createElement("div");iframeC.className="socketio",this.doc.body.appendChild(iframeC),this.iframe=this.doc.createElement("iframe"),iframeC.appendChild(this.iframe);var self=this,query=io.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+query,io.util.on(window,"unload",function(){self.destroy()})},HTMLFile.prototype._=function(data,doc){data=data.replace(/\\\//g,"/"),this.onData(data);try{var script=doc.getElementsByTagName("script")[0];script.parentNode.removeChild(script)}catch(e){}},HTMLFile.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(e){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},HTMLFile.prototype.close=function(){return this.destroy(),io.Transport.XHR.prototype.close.call(this)},HTMLFile.check=function(socket){if("undefined"!=typeof window&&["Active"].concat("Object").join("X")in window)try{var a=new(window[["Active"].concat("Object").join("X")])("htmlfile");return a&&io.Transport.XHR.check(socket)}catch(e){}return!1},HTMLFile.xdomainCheck=function(){return!1},io.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,io,global){function XHRPolling(){io.Transport.XHR.apply(this,arguments)}function empty(){}exports["xhr-polling"]=XHRPolling,io.util.inherit(XHRPolling,io.Transport.XHR),io.util.merge(XHRPolling,io.Transport.XHR),XHRPolling.prototype.name="xhr-polling",XHRPolling.prototype.heartbeats=function(){return!1},XHRPolling.prototype.open=function(){var self=this;return io.Transport.XHR.prototype.open.call(self),!1},XHRPolling.prototype.get=function(){function stateChange(){4==this.readyState&&(this.onreadystatechange=empty,200==this.status?(self.onData(this.responseText),self.get()):self.onClose())}function onload(){this.onload=empty,this.onerror=empty,self.retryCounter=1,self.onData(this.responseText),self.get()}function onerror(){self.retryCounter++,!self.retryCounter||self.retryCounter>3?self.onClose():self.get()}if(this.isOpen){var self=this;this.xhr=this.request(),global.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=onload,this.xhr.onerror=onerror):this.xhr.onreadystatechange=stateChange,this.xhr.send(null)}},XHRPolling.prototype.onClose=function(){if(io.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=empty;try{this.xhr.abort()}catch(e){}this.xhr=null}},XHRPolling.prototype.ready=function(socket,fn){var self=this;io.util.defer(function(){fn.call(self)})},io.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(exports,io,global){function JSONPPolling(){io.Transport["xhr-polling"].apply(this,arguments),this.index=io.j.length;var self=this;io.j.push(function(msg){self._(msg)})}var indicator=global.document&&"MozAppearance"in global.document.documentElement.style;exports["jsonp-polling"]=JSONPPolling,io.util.inherit(JSONPPolling,io.Transport["xhr-polling"]),JSONPPolling.prototype.name="jsonp-polling",JSONPPolling.prototype.post=function(data){function complete(){initIframe(),self.socket.setBuffer(!1)}function initIframe(){self.iframe&&self.form.removeChild(self.iframe);try{iframe=document.createElement('<iframe name="'+self.iframeId+'">')}catch(e){iframe=document.createElement("iframe"),iframe.name=self.iframeId}iframe.id=self.iframeId,self.form.appendChild(iframe),self.iframe=iframe}var self=this,query=io.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var iframe,form=document.createElement("form"),area=document.createElement("textarea"),id=this.iframeId="socketio_iframe_"+this.index;form.className="socketio",form.style.position="absolute",form.style.top="0px",form.style.left="0px",form.style.display="none",form.target=id,form.method="POST",form.setAttribute("accept-charset","utf-8"),area.name="d",form.appendChild(area),document.body.appendChild(form),this.form=form,this.area=area}this.form.action=this.prepareUrl()+query,initIframe(),this.area.value=io.JSON.stringify(data);try{this.form.submit()}catch(e){}this.iframe.attachEvent?iframe.onreadystatechange=function(){"complete"==self.iframe.readyState&&complete()}:this.iframe.onload=complete,this.socket.setBuffer(!0)},JSONPPolling.prototype.get=function(){var self=this,script=document.createElement("script"),query=io.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),script.async=!0,script.src=this.prepareUrl()+query,script.onerror=function(){self.onClose()};var insertAt=document.getElementsByTagName("script")[0];insertAt.parentNode.insertBefore(script,insertAt),this.script=script,indicator&&setTimeout(function(){var iframe=document.createElement("iframe");document.body.appendChild(iframe),document.body.removeChild(iframe)},100)},JSONPPolling.prototype._=function(msg){return this.onData(msg),this.isOpen&&this.get(),this},JSONPPolling.prototype.ready=function(socket,fn){var self=this;return indicator?void io.util.load(function(){fn.call(self)}):fn.call(this)},JSONPPolling.check=function(){return"document"in global},JSONPPolling.xdomainCheck=function(){return!0},io.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),"function"==typeof define&&define.amd&&define([],function(){return io})}();var apikey="bzkv7ePn",socket=io.connect("http://moontower.yhathq.com/"),frequency=1e3,mouseX=0,mouseY=0,userID=getCookie("moontower");userID=guid(),setCookie("moontower",userID,1/24),socket.emit("register",{apikey:apikey,userID:userID}),console.log("moontower started with ID: "+userID),document.body.addEventListener("mousemove",function(evt){mouseX=evt.clientX,mouseY=evt.clientY}),setInterval(function(){html2canvas(document.body,{onrendered:function(canvas){var img=canvas.toDataURL("images/png"),data={img:img,mousePosition:{x:mouseX/document.body.scrollWidth,y:mouseY/document.body.scrollHeight},apikey:apikey,userID:userID};socket.emit("screenshot",data)}})},frequency);